{% extends "base.html" %}
{% block title %}ویدیو دستی | Social Admin{% endblock %}
{% block page_title %}ایجاد ویدیو به صورت دستی{% endblock %}
{% block page_subtitle %}یک کمپین جدید ایجاد کنید و ویدیو را برای پردازش ثبت نمایید{% endblock %}
{% block content %}
<section class="panel">
    <header class="panel-header">
        <div>
            <h2>اطلاعات ویدیو</h2>
            <p class="panel-description">جزئیات ویدیو و کمپین را تکمیل کنید</p>
        </div>
    </header>
    <form method="post" action="/manual-video" class="form-grid">
        <div class="form-field">
            <label for="title">عنوان ویدیو <span class="required-marker" aria-hidden="true">*</span><span class="sr-only">فیلد اجباری</span></label>
            <input type="text" id="title" name="title" required>
        </div>
        <div class="form-field">
            <label for="media_url">لینک فایل ویدیو <span class="required-marker" aria-hidden="true">*</span><span class="sr-only">فیلد اجباری</span></label>
            <input type="url" id="media_url" name="media_url" placeholder="https://..." required>
        </div>
        <div class="form-field">
            <label for="media_type">نوع رسانه</label>
            <input type="text" id="media_type" name="media_type" value="video/mp4">
        </div>
        <div class="form-field">
            <label for="ai_tool">ابزار هوش مصنوعی مورد استفاده <span class="required-marker" aria-hidden="true">*</span><span class="sr-only">فیلد اجباری</span></label>
            <select id="ai_tool" name="ai_tool" required>
                <option value="" disabled selected>انتخاب ابزار</option>
                {% for tool in ai_tools %}
                    <option value="{{ tool }}">{{ tool }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-field full">
            <label for="description">توضیحات ویدیو</label>
            <textarea id="description" name="description" rows="3" placeholder="توضیحات اختیاری"></textarea>
        </div>
        <div class="form-field">
            <label for="campaign_name">نام کمپین <span class="required-marker" aria-hidden="true">*</span><span class="sr-only">فیلد اجباری</span></label>
            <input type="text" id="campaign_name" name="campaign_name" required>
        </div>
        <div class="form-field full">
            <label for="campaign_description">توضیحات کمپین</label>
            <textarea id="campaign_description" name="campaign_description" rows="3"></textarea>
        </div>
        <div class="form-actions">
            <button type="submit" class="btn">ثبت ویدیو</button>
        </div>
    </form>
</section>
<section class="panel">
    <header class="panel-header">
        <div>
            <h2>آخرین درخواست‌ها</h2>
            <p class="panel-description">نظارت بر وضعیت پردازش ویدیوهای ثبت‌شده</p>
        </div>
    </header>
    {% if jobs %}
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>عنوان</th>
                        <th>کمپین</th>
                        <th>ابزار هوش مصنوعی</th>
                        <th>وضعیت</th>
                        <th>پیشرفت</th>
                        <th>تاریخ ایجاد</th>
                    </tr>
                </thead>
                <tbody>
                    {% for job in jobs %}
                        <tr>
                            <td>{{ job.title }}</td>
                            <td>{{ job.campaign_name or '-' }}</td>
                            <td>{{ job.ai_tool }}</td>
                            <td><span class="badge {{ job.status_badge_class }}">{{ job.status_label }}</span></td>
                            <td>
                                <div class="status-progress" aria-label="پیشرفت پردازش">
                                    <div
                                        class="progress-track"
                                        role="progressbar"
                                        aria-valuenow="{{ job.progress_percent }}"
                                        aria-valuemin="0"
                                        aria-valuemax="100"
                                    >
                                        <div class="progress-value" style="width: {{ job.progress_percent }}%;"></div>
                                    </div>
                                    <div class="progress-meta">
                                        <span class="progress-percent">{{ job.progress_percent }}%</span>
                                        <span class="progress-description">{{ job.progress_description }}</span>
                                    </div>
                                </div>
                            </td>
                            <td>{{ job.created_at.strftime('%Y-%m-%d %H:%M') if job.created_at else '' }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <p class="empty">درخواستی برای نمایش وجود ندارد.</p>
    {% endif %}
</section>
{% endblock %}
