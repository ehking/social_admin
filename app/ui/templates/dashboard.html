{% extends "base.html" %}
{% block title %}داشبورد | Social Admin{% endblock %}
{% block page_title %}داشبورد مدیریتی{% endblock %}
{% block page_subtitle %}تصویر کلی از وضعیت حساب‌ها، پست‌های زمان‌بندی شده و توکن‌ها{% endblock %}
{% block content %}
<section class="grid grid-cards">
    <article class="card">
        <h2 class="card-title">تعداد حساب‌ها</h2>
        <p class="card-value">{{ accounts|length }}</p>
        <p class="card-meta">مدیریت حساب‌های متصل در صفحه حساب‌ها</p>
    </article>
    <article class="card">
        <h2 class="card-title">پست‌های در انتظار</h2>
        <p class="card-value">{{ scheduled_posts|length }}</p>
        <p class="card-meta">نزدیک‌ترین زمان‌بندی‌ها در جدول زیر آمده است</p>
    </article>
    <article class="card">
        <h2 class="card-title">توکن‌های فعال</h2>
        <p class="card-value">{{ tokens|length }}</p>
        <p class="card-meta">مدیریت کلیدها در صفحه تنظیمات</p>
    </article>
</section>
<section class="panel">
    <header class="panel-header">
        <h2>آخرین حساب‌های متصل</h2>
        <a class="btn btn-link" href="/accounts">مدیریت حساب‌ها</a>
    </header>
    {% if accounts %}
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>نام نمایشی</th>
                        <th>پلتفرم</th>
                        <th>شناسه صفحه</th>
                        <th>تاریخ ایجاد</th>
                    </tr>
                </thead>
                <tbody>
                    {% for account in accounts[:6] %}
                        <tr>
                            <td>{{ account.display_name }}</td>
                            <td>{{ account.platform }}</td>
                            <td>{{ account.page_id or '-' }}</td>
                            <td>{{ account.created_at.strftime('%Y-%m-%d %H:%M') if account.created_at else '' }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <p class="empty">هیچ حسابی ثبت نشده است.</p>
    {% endif %}
</section>
<section class="panel">
    <header class="panel-header">
        <h2>برنامه زمان‌بندی محتوا</h2>
        <a class="btn btn-link" href="/scheduler">مشاهده همه</a>
    </header>
    {% if scheduled_posts %}
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>عنوان</th>
                        <th>حساب</th>
                        <th>زمان اجرا</th>
                        <th>وضعیت</th>
                    </tr>
                </thead>
                <tbody>
                    {% for post in scheduled_posts[:8] %}
                        <tr>
                            <td>{{ post.title }}</td>
                            <td>{{ post.account.display_name if post.account else '-' }}</td>
                            <td>{{ post.scheduled_time.strftime('%Y-%m-%d %H:%M') if post.scheduled_time else '' }}</td>
                            <td><span class="badge badge-soft">{{ post.status or 'pending' }}</span></td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <p class="empty">پستی زمان‌بندی نشده است.</p>
    {% endif %}
</section>
<section class="panel">
    <header class="panel-header">
        <h2>توکن‌های سرویس</h2>
        <a class="btn btn-link" href="/settings">مدیریت توکن‌ها</a>
    </header>
    {% if tokens %}
        <div class="chips">
            {% for token in tokens[:10] %}
                <span class="chip">
                    <span class="chip-title">{{ token.name }}</span>
                    <span class="chip-subtitle">{{ token.key }}</span>
                </span>
            {% endfor %}
        </div>
    {% else %}
        <p class="empty">هیچ توکن فعالی ثبت نشده است.</p>
    {% endif %}
</section>
{% endblock %}
